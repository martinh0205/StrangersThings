{"ast":null,"code":"import _regeneratorRuntime from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{deletePost}from\"../api/api\";import\"./Posts.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Posts=function Posts(_ref){var posts=_ref.posts,setPosts=_ref.setPosts,token=_ref.token,username=_ref.username;console.log(posts);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];var _useState3=useState(posts),_useState4=_slicedToArray(_useState3,2),filteredPosts=_useState4[0],setFilteredPosts=_useState4[1];useEffect(function(){var searchTermLower=searchTerm.toLowerCase().split(\" \");if(searchTermLower){var filtered=posts.filter(function(postObject){var filterableValues=[postObject.title,postObject.description,postObject.location,postObject.price,postObject.author.username];for(var _i=0,_filterableValues=filterableValues;_i<_filterableValues.length;_i++){var value=_filterableValues[_i];if(value.toLowerCase().includes(searchTermLower)){return true;}}return false;});setFilteredPosts(filtered);}else{setFilteredPosts(posts);}},[searchTerm,posts]);var handleDeleteClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(postId){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return deletePost(token,postId);case 2:setPosts(function(prevPosts){return prevPosts.filter(function(post){return post.Id!==postId;});});case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleDeleteClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsx(\"h1\",{className:\"ui centered header\",children:\"Posts\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-nav\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search\",value:searchTerm,onChange:function onChange(event){setSearchTerm(event.target.value);}}),token?/*#__PURE__*/_jsx(Link,{to:\"/posts/create\",className:\"ui button\",children:\"Create Post\"}):null]}),/*#__PURE__*/_jsx(\"section\",{children:filteredPosts.map(function(posts){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"posts-container \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ui fluid card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"left floated aligned header\",children:/*#__PURE__*/_jsx(\"h1\",{children:posts.title})}),/*#__PURE__*/_jsx(\"p\",{className:\"description\",children:posts.description}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:posts.price}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:posts.author.username}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:posts.location})]}),/*#__PURE__*/_jsx(\"div\",{className:\"center aligned header\",children:/*#__PURE__*/_jsx(Link,{to:\"/posts/\".concat(posts._id),children:\"View Post\"})}),posts.isAuthor&&token?/*#__PURE__*/_jsx(\"button\",{className:\"negative ui button left floated\",onClick:function onClick(){handleDeleteClick(posts._id);},children:\"Delete\"}):null,/*#__PURE__*/_jsx(\"div\",{role:\"list\",className:\"ui divided relaxed list\",style:{color:\"#444\",clear:\"both\"},children:posts.messages.map(function(messages){return/*#__PURE__*/_jsx(\"div\",{role:\"listitem\",className:\"item\",children:messages.fromUser.username!==username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"b\",{className:\"comments\",children:[messages.fromUser.username,\" \"]}),/*#__PURE__*/_jsx(\"p\",{className:\"comments\",children:messages.content})]}):null},messages._id);})})]})},posts._id)});})})]});};export default Posts;","map":{"version":3,"names":["React","useState","useEffect","Link","deletePost","Posts","posts","setPosts","token","username","console","log","searchTerm","setSearchTerm","filteredPosts","setFilteredPosts","searchTermLower","toLowerCase","split","filtered","filter","postObject","filterableValues","title","description","location","price","author","value","includes","handleDeleteClick","postId","prevPosts","post","Id","event","target","map","_id","isAuthor","color","clear","messages","fromUser","content"],"sources":["/Users/martinhampton/Documents/course_work/StrangersThings/src/components/Posts.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { deletePost } from \"../api/api\";\nimport \"./Posts.css\";\n\nconst Posts = ({ posts, setPosts, token, username }) => {\n  console.log(posts);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filteredPosts, setFilteredPosts] = useState(posts);\n\n  useEffect(() => {\n    const searchTermLower = searchTerm.toLowerCase().split(\" \");\n    if (searchTermLower) {\n      const filtered = posts.filter((postObject) => {\n        const filterableValues = [\n          postObject.title,\n          postObject.description,\n          postObject.location,\n          postObject.price,\n          postObject.author.username,\n        ];\n\n        for (let value of filterableValues) {\n          if (value.toLowerCase().includes(searchTermLower)) {\n            return true;\n          }\n        }\n        return false;\n      });\n      setFilteredPosts(filtered);\n    } else {\n      setFilteredPosts(posts);\n    }\n  }, [searchTerm, posts]);\n\n  const handleDeleteClick = async (postId) => {\n    await deletePost(token, postId);\n    setPosts((prevPosts) => prevPosts.filter((post) => post.Id !== postId));\n  };\n\n  return (\n    <>\n      <header>\n        <h1 className=\"ui centered header\">Posts</h1>\n      </header>\n      <div className=\"post-nav\">\n        <input\n          type=\"text\"\n          placeholder=\"Search\"\n          value={searchTerm}\n          onChange={(event) => {\n            setSearchTerm(event.target.value);\n          }}\n        ></input>\n        {token ? (\n          <Link to=\"/posts/create\" className=\"ui button\">\n            Create Post\n          </Link>\n        ) : null}\n      </div>\n\n      <section>\n        {filteredPosts.map((posts) => {\n          return (\n            <>\n              <div className=\"posts-container \" key={posts._id}>\n                <div className=\"ui fluid card\">\n                  <div className=\"content\">\n                    <div className=\"left floated aligned header\">\n                      <h1>{posts.title}</h1>\n                    </div>\n\n                    <p className=\"description\">{posts.description}</p>\n\n                    <p className=\"center aligned extra content\">\n                      {posts.price}\n                    </p>\n                    <p className=\"center aligned extra content\">\n                      {posts.author.username}\n                    </p>\n                    <p className=\"center aligned extra content\">\n                      {posts.location}\n                    </p>\n                  </div>\n                  <div className=\"center aligned header\">\n                    <Link to={`/posts/${posts._id}`}>View Post</Link>\n                  </div>\n                  {posts.isAuthor && token ? (\n                    <button\n                      className=\"negative ui button left floated\"\n                      onClick={() => {\n                        handleDeleteClick(posts._id);\n                      }}\n                    >\n                      Delete\n                    </button>\n                  ) : null}\n\n                  <div\n                    role=\"list\"\n                    className=\"ui divided relaxed list\"\n                    style={{ color: \"#444\", clear: \"both\" }}\n                  >\n                    {posts.messages.map((messages) => {\n                      return (\n                        <div\n                          role=\"listitem\"\n                          className=\"item\"\n                          key={messages._id}\n                        >\n                          {messages.fromUser.username !== username ? (\n                            <>\n                              <b className=\"comments\">\n                                {messages.fromUser.username}{\" \"}\n                              </b>\n                              <p className=\"comments\">{messages.content}</p>\n                            </>\n                          ) : null}\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            </>\n          );\n        })}\n      </section>\n    </>\n  );\n};\n\nexport default Posts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}