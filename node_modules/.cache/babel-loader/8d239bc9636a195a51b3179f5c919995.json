{"ast":null,"code":"import _regeneratorRuntime from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useParams}from\"react-router-dom\";import{addComment}from\"../api/api\";import\"./Posts.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PostDetail=function PostDetail(props){var token=props.token,posts=props.posts,getPosts=props.getPosts,username=props.username;var _useParams=useParams(),postId=_useParams.postId;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),commentText=_useState2[0],setCommentText=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var singlePost=posts.find(function(onePost){var foundPost=onePost._id==postId;return foundPost;});console.log(singlePost);console.log(\"post detail username\",username,singlePost);var handleOnSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _yield$addComment,success,error,content;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.next=3;return addComment(token,postId,commentText);case 3:_yield$addComment=_context.sent;success=_yield$addComment.success;error=_yield$addComment.error;content=_yield$addComment.content;if(!success){_context.next=14;break;}console.log(\"we succesfully added a comment\");setCommentText(\"\");_context.next=12;return getPosts();case 12:_context.next=16;break;case 14:setErrorMessage(error);console.log(\"failed to add a comment\");case 16:case\"end\":return _context.stop();}}},_callee);}));return function handleOnSubmit(_x){return _ref.apply(this,arguments);};}();if(singlePost){return/*#__PURE__*/_jsx(\"div\",{className:\"posts-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"ui fluid card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"left floated aligned header\",children:/*#__PURE__*/_jsx(\"h1\",{children:singlePost.title})}),/*#__PURE__*/_jsx(\"p\",{className:\"description\",children:singlePost.description}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:singlePost.price}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:singlePost.author.username}),/*#__PURE__*/_jsx(\"p\",{className:\"center aligned extra content\",children:singlePost.location}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{role:\"list\",className:\"ui divided relaxed list\",style:{color:\"#444\",clear:\"both\"},children:singlePost.messages.map(function(messages){return/*#__PURE__*/_jsx(\"div\",{role:\"listitem\",className:\"item\",children:messages.fromUser.username!==username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"b\",{children:[messages.fromUser.username,\" \"]}),/*#__PURE__*/_jsx(\"p\",{className:\"content\",children:messages.content})]}):null},messages._id);})}),token?/*#__PURE__*/_jsxs(\"form\",{className:\"comment-form\",onSubmit:handleOnSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"New Comment\",value:commentText,onChange:function onChange(event){setCommentText(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Send\"}),errorMessage?/*#__PURE__*/_jsxs(\"p\",{style:{color:\"red\",backgroundColor:\"pink\"},children:[\"Operation Failed \",errorMessage,\" \"]}):null]}):null]})]})})});}else{return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}};export default PostDetail;","map":{"version":3,"names":["React","useState","useParams","addComment","PostDetail","props","token","posts","getPosts","username","postId","commentText","setCommentText","errorMessage","setErrorMessage","singlePost","find","onePost","foundPost","_id","console","log","handleOnSubmit","event","preventDefault","success","error","content","title","description","price","author","location","color","clear","messages","map","fromUser","target","value","backgroundColor"],"sources":["/Users/martinhampton/Documents/course_work/StrangersThings/src/components/PostDetail.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { addComment } from \"../api/api\";\nimport \"./Posts.css\";\n\nconst PostDetail = (props) => {\n  const { token, posts, getPosts, username } = props;\n  const { postId } = useParams();\n  const [commentText, setCommentText] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const singlePost = posts.find((onePost) => {\n    const foundPost = onePost._id == postId;\n    return foundPost;\n  });\n\n  console.log(singlePost);\n  console.log(\"post detail username\", username, singlePost);\n\n  const handleOnSubmit = async (event) => {\n    event.preventDefault();\n    const { success, error, content } = await addComment(\n      token,\n      postId,\n      commentText\n    );\n\n    if (success) {\n      console.log(\"we succesfully added a comment\");\n      setCommentText(\"\");\n      await getPosts();\n    } else {\n      setErrorMessage(error);\n      console.log(\"failed to add a comment\");\n    }\n  };\n\n  if (singlePost) {\n    return (\n      <div className=\"posts-container\">\n        <div className=\"ui fluid card\">\n          <div className=\"content\">\n            <div className=\"left floated aligned header\">\n              <h1>{singlePost.title}</h1>\n            </div>\n\n            <p className=\"description\">{singlePost.description}</p>\n\n            <p className=\"center aligned extra content\">{singlePost.price}</p>\n            <p className=\"center aligned extra content\">\n              {singlePost.author.username}\n            </p>\n            <p className=\"center aligned extra content\">\n              {singlePost.location}\n            </p>\n\n            <>\n              <div\n                role=\"list\"\n                className=\"ui divided relaxed list\"\n                style={{ color: \"#444\", clear: \"both\" }}\n              >\n                {singlePost.messages.map((messages) => {\n                  return (\n                    <div role=\"listitem\" className=\"item\" key={messages._id}>\n                      {messages.fromUser.username !== username ? (\n                        <>\n                          <b>{messages.fromUser.username} </b>\n                          <p className=\"content\">{messages.content}</p>\n                        </>\n                      ) : null}\n                    </div>\n                  );\n                })}\n              </div>\n              {token ? (\n                <form className=\"comment-form\" onSubmit={handleOnSubmit}>\n                  <input\n                    type=\"text\"\n                    placeholder=\"New Comment\"\n                    value={commentText}\n                    onChange={(event) => {\n                      setCommentText(event.target.value);\n                    }}\n                  ></input>\n                  <button type=\"submit\">Send</button>\n                  {errorMessage ? (\n                    <p style={{ color: \"red\", backgroundColor: \"pink\" }}>\n                      Operation Failed {errorMessage}{\" \"}\n                    </p>\n                  ) : null}\n                </form>\n              ) : null}\n            </>\n          </div>\n        </div>\n      </div>\n    );\n  } else {\n    return <p>Loading...</p>;\n  }\n};\n\nexport default PostDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}