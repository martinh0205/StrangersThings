{"ast":null,"code":"import _regeneratorRuntime from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/martinhampton/Documents/course_work/StrangersThings/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Home,Posts,AccountForm,PostCreateForm,PostDetail,Profile}from\"./components\";import{Route,Switch,Link,useHistory}from\"react-router-dom\";import{fetchPosts,fetchUser}from\"./api/api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(_ref){var username=_ref.username,filteredPosts=_ref.filteredPosts;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(window.localStorage.getItem(\"token\")||null),_useState4=_slicedToArray(_useState3,2),token=_useState4[0],setToken=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var history=useHistory();var getPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$fetchPosts,error,posts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchPosts(token);case 2:_yield$fetchPosts=_context.sent;error=_yield$fetchPosts.error;posts=_yield$fetchPosts.posts;if(error){console.error(error);}setPosts(posts);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getPosts(){return _ref2.apply(this,arguments);};}();useEffect(function(){getPosts();},[token]);/* useEffect(() => {\n    const getPosts = async () => {\n      try {\n        const result = await fetchPosts();\n        setPosts(result);\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    getPosts();\n  }, []);\n\n  */useEffect(function(){console.log(\"HERE\");if(token){var getUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$fetchUser,username;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchUser(token);case 2:_yield$fetchUser=_context2.sent;username=_yield$fetchUser.username;console.log(\"username\",username);setUser(username);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function getUser(){return _ref3.apply(this,arguments);};}();getUser();}},[token]);useEffect(function(){if(token){window.localStorage.setItem(\"token\",token);}else{window.localStorage.removeItem(\"token\");}},[token]);var logOut=function logOut(){setToken(null);setUser(null);history.push(\"/\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"nav\",{className:\"ui pointing secondary menu\",children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/Posts\",children:\"Posts\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"right menu\",children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/Profile\",children:\"Profile\"}),token?/*#__PURE__*/_jsx(\"button\",{onClick:logOut,className:\"item\",children:\"Log Out\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/Account/login\",children:\"Login\"}),/*#__PURE__*/_jsx(Link,{className:\"item\",to:\"/Account/register\",children:\"Sign Up\"})]})]})]}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{className:\"item\",exact:true,path:\"/\",children:/*#__PURE__*/_jsx(Home,{username:user})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/posts/create\",children:/*#__PURE__*/_jsx(PostCreateForm,{token:token,setPosts:setPosts})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/posts/:postId\",children:/*#__PURE__*/_jsx(PostDetail,{posts:posts,token:token,getPosts:getPosts,username:user})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/Posts\",children:/*#__PURE__*/_jsx(Posts,{posts:posts,token:token,setPosts:setPosts,username:user})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/Account/:action\",children:/*#__PURE__*/_jsx(AccountForm,{setToken:setToken})}),/*#__PURE__*/_jsx(Route,{className:\"item\",path:\"/Profile\",children:/*#__PURE__*/_jsx(Profile,{posts:posts,token:token,getPosts:getPosts,username:user,filteredPosts:filteredPosts})})]})]});};export default App;","map":{"version":3,"names":["React","useEffect","useState","Home","Posts","AccountForm","PostCreateForm","PostDetail","Profile","Route","Switch","Link","useHistory","fetchPosts","fetchUser","App","username","filteredPosts","posts","setPosts","window","localStorage","getItem","token","setToken","user","setUser","history","getPosts","error","console","log","getUser","setItem","removeItem","logOut","push"],"sources":["/Users/martinhampton/Documents/course_work/StrangersThings/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport {\n  Home,\n  Posts,\n  AccountForm,\n  PostCreateForm,\n  PostDetail,\n  Profile,\n} from \"./components\";\nimport { Route, Switch, Link, useHistory } from \"react-router-dom\";\nimport { fetchPosts, fetchUser } from \"./api/api\";\n\nconst App = ({ username, filteredPosts }) => {\n  const [posts, setPosts] = useState([]);\n  const [token, setToken] = useState(\n    window.localStorage.getItem(\"token\") || null\n  );\n  const [user, setUser] = useState(null);\n\n  const history = useHistory();\n\n  const getPosts = async () => {\n    const { error, posts } = await fetchPosts(token);\n\n    if (error) {\n      console.error(error);\n    }\n    setPosts(posts);\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, [token]);\n\n  /* useEffect(() => {\n    const getPosts = async () => {\n      try {\n        const result = await fetchPosts();\n        setPosts(result);\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    getPosts();\n  }, []);\n\n  */\n\n  useEffect(() => {\n    console.log(\"HERE\");\n    if (token) {\n      const getUser = async () => {\n        const { username } = await fetchUser(token);\n        console.log(\"username\", username);\n        setUser(username);\n      };\n      getUser();\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (token) {\n      window.localStorage.setItem(\"token\", token);\n    } else {\n      window.localStorage.removeItem(\"token\");\n    }\n  }, [token]);\n\n  const logOut = () => {\n    setToken(null);\n    setUser(null);\n    history.push(\"/\");\n  };\n\n  return (\n    <div className=\"container\">\n      <nav className=\"ui pointing secondary menu\">\n        <Link className=\"item\" to=\"/\">\n          Home\n        </Link>\n        <Link className=\"item\" to=\"/Posts\">\n          Posts\n        </Link>\n        <div className=\"right menu\">\n          <Link className=\"item\" to=\"/Profile\">\n            Profile\n          </Link>\n          {token ? (\n            <button onClick={logOut} className=\"item\">\n              Log Out\n            </button>\n          ) : (\n            <>\n              <Link className=\"item\" to=\"/Account/login\">\n                Login\n              </Link>\n              <Link className=\"item\" to=\"/Account/register\">\n                Sign Up\n              </Link>\n            </>\n          )}\n        </div>\n      </nav>\n      <Switch>\n        <Route className=\"item\" exact path=\"/\">\n          <Home username={user} />\n        </Route>\n        <Route className=\"item\" path=\"/posts/create\">\n          <PostCreateForm token={token} setPosts={setPosts} />\n        </Route>\n        <Route className=\"item\" path=\"/posts/:postId\">\n          <PostDetail\n            posts={posts}\n            token={token}\n            getPosts={getPosts}\n            username={user}\n          />\n        </Route>\n        <Route className=\"item\" path=\"/Posts\">\n          <Posts\n            posts={posts}\n            token={token}\n            setPosts={setPosts}\n            username={user}\n          />\n        </Route>\n        <Route className=\"item\" path=\"/Account/:action\">\n          <AccountForm setToken={setToken} />\n        </Route>\n\n        <Route className=\"item\" path=\"/Profile\">\n          <Profile\n            posts={posts}\n            token={token}\n            getPosts={getPosts}\n            username={user}\n            filteredPosts={filteredPosts}\n          />\n        </Route>\n      </Switch>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}